\documentclass[10pt]{article}

\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage[fleqn]{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage[ruled,linesnumbered,noend]{algorithm2e}
\usepackage{empheq}
\usepackage{float}
\usepackage{enumitem}
\usepackage{tikz}
\usepackage[colorlinks=true,urlcolor=blue]{hyperref}

\title{Introduction to Machine Learning, Fall 2014 - Exercise session IV}
\author{Rodion ``rodde'' Efremov \\ 013593012}

\begin{document}
 \maketitle

\section*{Problem 1 (6 points)}
\subsection*{(a)}
We seek to compute 
\[
P(Y \,| \, \textbf{X}) = \frac{P(\textbf{X} \, | \, Y) P(Y)}{P(\textbf{X})},
\]
where
\[
P(\textbf{X}) = \sum_{i = 0}^2 P(\textbf{X} \, | \, Y = i)P(Y = i).
\]
\subsubsection*{(0, 0)}
If $\textbf{X} = (0,0)$, 
\begin{align*}
P((0, 0)) &= \sum_{i = 0}^2 P((0, 0) \, | \, Y = i)P(Y = i) \\
             &= 0.2 \times 0.4 + 0.6 \times 0.3 + 0.1 \times 0.3 \\
             &= 0.08 + 0.18 + 0.03 \\
             &= 0.29.
\end{align*}
\begin{align*}
P(Y = 0 \, | (0,0)) &= \frac{P((0, 0) \, | \, Y = 0)P(Y = 0)}{P((0,0))} \\
                           &= \frac{0.2 \times 0.4}{ 0.29 } \\
                           &= \frac{0.08}{0.29} \\
                           &\approx 0.276,
\end{align*}
\begin{align*}
P(Y = 1 \, | (0,0)) &= \frac{P((0, 0) \, | \, Y = 1)P(Y = 1)}{P((0, 0))} \\
                           &= \frac{0.6 \times 0.3}{ 0.29 } \\
                           &= \frac{0.18}{0.29} \\
                           &\approx 0.621,
\end{align*}
\begin{align*}
P(Y = 2 \, | (0,0)) &= \frac{P((0, 0) \, | \, Y = 2)P(Y = 2)}{P((0, 0))} \\
                           &= \frac{0.1 \times 0.3}{ 0.29 } \\
                           &= \frac{0.03}{0.29} \\
                           &\approx 0.103.
\end{align*}

\subsubsection*{(0, 1)}
If $\textbf{X} = (0,1)$, 
\begin{align*}
P((0, 1)) &= \sum_{i = 0}^2 P((0, 1) \, | \, Y = i)P(Y = i) \\
             &= 0.4 \times 0.4 + 0.1 \times 0.3 + 0.3 \times 0.3 \\
             &= 0.16 + 0.03 + 0.09 \\
             &= 0.28.
\end{align*}
\begin{align*}
P(Y = 0 \, | (0,1)) &= \frac{P((0, 1) \, | \, Y = 0)P(Y = 0)}{ 0.28 } \\
                           &= \frac{0.4 \times 0.4}{ 0.28 } \\
                           &= \frac{0.16}{ 0.28 } \\
                           &\approx 0.571,
\end{align*}
\begin{align*}
P(Y = 1 \, | (0,1)) &= \frac{P((0, 1) \, | \, Y = 1)P(Y = 1)}{ 0.28 } \\
                           &= \frac{0.1 \times 0.3}{ 0.28 } \\
                           &= \frac{0.03 }{ 0.28 } \\
                           &\approx 0.107,
\end{align*}
\begin{align*}
P(Y = 2 \, | (0,1)) &= \frac{P((0, 1) \, | \, Y = 2)P(Y = 2)}{ 0.28 } \\
                           &= \frac{ 0.3 \times 0.3 }{ 0.28 } \\
                           &= \frac{ 0.09 }{ 0.28 } \\
                           &\approx 0.321.
\end{align*}

\subsubsection*{(0, 2)}
If $\textbf{X} = (0,2)$, 
\begin{align*}
P((0, 2)) &= \sum_{i = 0}^2 P((0, 2) \, | \, Y = i)P(Y = i) \\
             &= 0.0 \times 0.4 + 0.1 \times 0.3 + 0.2 \times 0.3 \\
             &= 0.03 + 0.06 \\
             &= 0.09,
\end{align*}
\begin{align*}
P(Y = 0 \, | (0,2)) &= \frac{P((0, 2) \, | \, Y = 0)P(Y = 0)}{ 0.09 } \\
                           &= \frac{0.0 \times 0.4}{ 0.09 } \\
                           &= 0,
\end{align*}
\begin{align*}
P(Y = 1 \, | (0,2)) &= \frac{P((0, 2) \, | \, Y = 1)P(Y = 1)}{ 0.09 } \\
                           &= \frac{0.1 \times 0.3}{ 0.09 } \\
                           &= \frac{ 0.03 }{ 0.09 } \\
                           &\approx 0.333,
\end{align*}
\begin{align*}
P(Y = 2 \, | (0,2)) &= \frac{P((0, 2) \, | \, Y = 2)P(Y = 2)}{ 0.09 } \\
                           &= \frac{ 0.2 \times 0.3 }{ 0.09 } \\
                           &= \frac{ 0.06 }{ 0.09 } \\
                           &\approx 0.666.
\end{align*}

\subsubsection*{(1, 0)}
If $\textbf{X} = (1, 0)$, 
\begin{align*}
P((1, 0)) &= \sum_{i = 0}^2 P((1, 0) \, | \, Y = i)P(Y = i) \\
             &= 0.1 \times 0.4 + 0.1 \times 0.3 + 0.4 \times 0.3 \\
             &= 0.04 + 0.03 + 0.12 \\
             &= 0.19,
\end{align*}
\begin{align*}
P(Y = 0 \, | (1,0)) &= \frac{P((1, 0) \, | \, Y = 0)P(Y = 0)}{ 0.19 } \\
                           &= \frac{0.1 \times 0.4}{ 0.19 } \\
                           &= \frac{ 0.04 }{ 0.19 } \\
                           &\approx 0.211,
\end{align*}
\begin{align*}
P(Y = 1 \, | (1,0)) &= \frac{ P((1, 0) \, | \, Y = 1)P(Y = 1) }{ 0.19 } \\
                           &= \frac{ 0.1 \times 0.3 }{ 0.19 } \\
                           &= \frac{ 0.03 }{ 0.19 } \\
                           &\approx 0.158,
\end{align*}
\begin{align*}
P(Y = 2 \, | (1,0)) &= \frac{P((1, 0) \, | \, Y = 2)P(Y = 2)}{ 0.19 } \\
                           &= \frac{ 0.4 \times 0.3 }{ 0.19 } \\
                           &= \frac{ 0.12 }{ 0.19 } \\
                           &\approx 0.632.
\end{align*}

\subsubsection*{(1, 1)}
If $\textbf{X} = (1, 1)$, 
\begin{align*}
P((1, 1)) &= \sum_{i = 0}^2 P((1, 1) \, | \, Y = i)P(Y = i) \\
             &= 0.2 \times 0.4 + 0.1 \times 0.3 + 0.0 \times 0.3 \\
             &= 0.08 + 0.03 \\
             &= 0.11,
\end{align*}
\begin{align*}
P(Y = 0 \, | (1,1)) &= \frac{P((1, 1) \, | \, Y = 0)P(Y = 0)}{ 0.11 } \\
                           &= \frac{0.2 \times 0.4}{ 0.11 } \\
                           &= \frac{ 0.08 }{ 0.11 } \\
                           &\approx 0.727,
\end{align*}
\begin{align*}
P(Y = 1 \, | (1,1)) &= \frac{ P((1, 1) \, | \, Y = 1)P(Y = 1) }{ 0.11 } \\
                           &= \frac{ 0.1 \times 0.3 }{ 0.11 } \\
                           &= \frac{ 0.03 }{ 0.11 } \\
                           &\approx 0.273,
\end{align*}
\begin{align*}
P(Y = 2 \, | (1,1)) &= \frac{P((1, 1) \, | \, Y = 2)P(Y = 2)}{ 0.11 } \\
                           &= \frac{ 0.0 \times 0.3 }{ 0.11 } \\
                           &= 0.0.
\end{align*}

\subsubsection*{(1, 2)}
If $\textbf{X} = (1, 2)$, 
\begin{align*}
P((1, 2)) &= \sum_{i = 0}^2 P((1, 2) \, | \, Y = i)P(Y = i) \\
             &= 0.1 \times 0.4 + 0.0 \times 0.3 + 0.0 \times 0.3 \\
             &= 0.04,
\end{align*}
\begin{align*}
P(Y = 0 \, | (1,2)) &= \frac{P((1, 2) \, | \, Y = 0)P(Y = 0)}{ 0.04 } \\
                           &= \frac{0.1 \times 0.4}{ 0.04 } \\
                           &= 1.0,
\end{align*}
\begin{align*}
P(Y = 1 \, | (1,2)) &= \frac{ P((1, 2) \, | \, Y = 1)P(Y = 1) }{ 0.04 } \\
                           &= \frac{ 0.0 \times 0.3 }{ 0.11 } \\
                           &= 0.0,
\end{align*}
\begin{align*}
P(Y = 2 \, | (1,2)) &= \frac{P((1, 2) \, | \, Y = 2)P(Y = 2)}{ 0.04 } \\
                           &= \frac{ 0.0 \times 0.3 }{ 0.11 } \\
                           &= 0.0.
\end{align*}

\subsubsection*{Summary}
\begin{tabular}{|l|c|c|c|}
  \hline
  & $Y = 0$ & $Y = 1$ & $Y = 2$ \\
  \hline
  $(0, 0)$ & 0.276 & 0.621 & 0.103 \\
  \hline
  $(0, 1)$ & 0.571 & 0.107 & 0.321 \\
  \hline
  $(0, 2)$ & 0.0 & 0.333 & 0.667 \\
  \hline
  $(1, 0)$ & 0.211 & 0.158 & 0.631 \\
  \hline
  $(1, 1)$ & 0.727 & 0.273 & 0.0 \\
  \hline
  $(1, 2)$ & 1.0 & 0.0 & 0.0 \\
  \hline
\end{tabular}

The optimal Bayes classifier is
\begin{align*}
Y(\textbf{X}) = \begin{cases}
0 & \mbox{if } \textbf{X} \in \{ (0, 1), (1, 1), (1, 2) \} \\ 
1 & \mbox{if } \textbf{X} = (0, 0) \\
2 & \mbox{if } \textbf{X} \in \{ (0, 2), (1, 0) \}.
\end{cases}
\end{align*}

\subsection*{(c)}
For na√Øve Bayes classifier in this context, we have
\[
P(\textbf{X} \, | \, Y = y) = \prod_{i = 1}^2 P(X_i \, | \, Y = y) = P(X_1 \, | \, Y = y)P(X_2 \, | \, Y = y),
\]
so we seek to compute
\[
P(Y = y \, | \, \textbf{X}) = \frac{ P(\textbf{X} \, | \, Y = y)P(Y = y) }{ P(\textbf{X}) } = \frac{ P(X_1 \, | \, Y = y) P(X_2 \, | \, Y = y) P(Y = y) }{ P(\textbf{X}) },
\]
where 
\begin{align*}
P(\textbf{X}) &= \sum_{i = 0}^2 P(\textbf{X} \, | \, Y = i)P(Y = i) \\
                    &= \sum_{i = 0}^2 P(X_1 \, | \, Y =i)P(X_2 \, | \, Y = i)P(Y = i).
\end{align*}

\subsubsection*{$(0, 0)$}
If $\textbf{X} = (0, 0)$, and
\begin{align*}
P(\textbf{X}) &= \sum_{i = 0}^2 P(X_1 \, | \, Y = i)P(X_2 \, | \, Y = i)P(Y = i) \\
             &= (0.2 + 0.4 + 0.0) \times (0.2 + 0.1) \times 0.4 \\
             &+ (0.6 + 0.1 + 0.1) \times (0.6 + 0.1) \times 0.3 \\
             &+ (0.1 + 0.3 + 0.2) \times (0.1 + 0.4) \times 0.3 \\
             &= 0.6 \times 0.3 \times 0.4 + 0.8 \times 0.7 \times 0.3 + 0.6 \times 0.5 \times 0.3 \\
             &= 0.072 + 0.168 + 0.09 \\
             &= 0.33.
\end{align*}
\begin{align*}
P(Y = 0 \, | \, (0, 0)) &= \frac{P(X_1 \, | \, Y = 0)P(X_2 \, | \, Y = 0)P(Y = 0)}{ 0.33 } \\
     &= \frac{ (0.2 + 0.4 + 0.0) \times (0.2 + 0.1) \times 0.4 }{ 0.33 } \\
     &= \frac{ 0.6 \times 0.3 \times 0.4 }{ 0.33 } \\
     &= \frac{ 0.072 }{ 0.33 } \\
     &\approx 0.218,
\end{align*}
\begin{align*}
P(Y = 1 \, | \, (0, 0)) &= \frac{ P(X_1 \, | \, Y = 1)P(X_2 \, | \,  Y = 1)P(Y = 1)}{ 0.33 } \\
     &= \frac{ (0.6 + 0.1 + 0.1) \times (0.6 + 0.1) \times 0.3 }{ 0.33 } \\
     &= \frac{ 0.8 \times 0.7 \times 0.3 }{ 0.33 } \\
     &= \frac{ 0.168 }{ 0.33 } \\
     &\approx 0.509,
\end{align*}
\begin{align*}
P(Y = 2 \, | \, (0, 0)) &= \frac{ P(X_1 \, | \, Y = 2)P(X_2 \, | \, Y = 2)P(Y = 2) }{ 0.33 } \\
     &= \frac{ (0.1 + 0.3 + 0.2) \times (0.1 + 0.4) \times 0.3 }{ 0.33 } \\
     &= \frac{ 0.6 \times 0.5 \times 0.3}{ 0.33 } \\
     &= \frac{ 0.09	 }{ 0.33 } \\
     &\approx 0.273.
\end{align*}

\subsubsection*{$(0, 1)$}
If $\textbf{X} = (0, 1)$, and
\begin{align*}
P(\textbf{X}) &= \sum_{i = 0}^2 P(X_1 \, | \, Y = i)P(X_2 \, | \, Y = i)P(Y = i) \\
             &= (0.2 + 0.4 + 0.0) \times (0.4 + 0.2) \times 0.4 \\
             &+ (0.6 + 0.1 + 0.1) \times (0.1 + 0.1) \times 0.3 \\
             &+ (0.1 + 0.3 + 0.2) \times (0.3 + 0.0) \times 0.3 \\
             &= 0.6 \times 0.6 \times 0.4 + 0.8 \times 0.2 \times 0.3 + 0.6 \times 0.3 \times 0.3 \\
             &= 0.144 + 0.048 + 0.054 \\
             &= 0.246.
\end{align*}
\begin{align*}
P(Y = 0 \, | \, (0, 1)) &= \frac{P(X_1= 0 \, | \, Y = 0)P(X_2 = 1 \, | \, Y = 0)P(Y = 0)}{ 0.246 } \\
     &= \frac{ (0.2 + 0.4 + 0.0) \times (0.4 + 0.2) \times 0.4 }{ 0.246 } \\
     &= \frac{ 0.6 \times 0.6 \times 0.4 }{ 0.246 } \\
     &= \frac{ 0.144 }{ 0.246 } \\
     &\approx 0.585,
\end{align*}
\begin{align*}
P(Y = 1 \, | \, (0, 1)) &= \frac{ P(X_1 = 0 \, | \, Y = 1)P(X_2 = 1\, | \,  Y = 1)P(Y = 1)}{ 0.246 } \\
     &= \frac{ (0.6 + 0.1 + 0.1) \times (0.1 + 0.1) \times 0.3 }{ 0.246 } \\
     &= \frac{ 0.8 \times 0.2 \times 0.3 }{ 0.246 } \\
     &= \frac{ 0.048 }{ 0.246 } \\
     &\approx 0.195,
\end{align*}
\begin{align*}
P(Y = 2 \, | \, (0, 1)) &= \frac{ P(X_1 = 0 \, | \, Y = 2)P(X_2 = 1 \, | \, Y = 2)P(Y = 2) }{ 0.246 } \\
     &= \frac{ (0.1 + 0.3 + 0.2) \times (0.3 + 0.0) \times 0.3 }{ 0.246 } \\
     &= \frac{ 0.6 \times 0.3 \times 0.3}{ 0.246 } \\
     &= \frac{ 0.054	 }{ 0.246 } \\
     &\approx 0.219.
\end{align*}

\subsubsection*{$(0, 2)$}
If $\textbf{X} = (0, 2)$, and
\begin{align*}
P(\textbf{X}) &= \sum_{i = 0}^2 P(X_1 \, | \, Y = i)P(X_2 \, | \, Y = i)P(Y = i) \\
             &= (0.2 + 0.4 + 0.0) \times (0.0 + 0.1) \times 0.4 \\
             &+ (0.6 + 0.1 + 0.1) \times (0.1 + 0.0) \times 0.3 \\
             &+ (0.1 + 0.3 + 0.2) \times (0.2 + 0.0) \times 0.3 \\
             &= 0.6 \times 0.1 \times 0.4 + 0.8 \times 0.1 \times 0.3 + 0.6 \times 0.2 \times 0.3 \\
             &= 0.024 + 0.024 + 0.036 \\
             &= 0.084.
\end{align*}
\begin{align*}
P(Y = 0 \, | \, (0, 2)) &= \frac{P(X_1= 0 \, | \, Y = 0)P(X_2 = 2 \, | \, Y = 0)P(Y = 0)}{ 0.084 } \\
     &= \frac{ (0.2 + 0.4 + 0.0) \times (0.0 + 0.1) \times 0.4 }{ 0.084 } \\
     &= \frac{ 0.6 \times 0.1 \times 0.4 }{ 0.084 } \\
     &= \frac{ 0.024 }{ 0.084 } \\
     &\approx 0.286,
\end{align*}
\begin{align*}
P(Y = 1 \, | \, (0, 2)) &= \frac{ P(X_1 = 0 \, | \, Y = 1)P(X_2 = 2\, | \,  Y = 1)P(Y = 1)}{ 0.084 } \\
     &= \frac{ (0.6 + 0.1 + 0.1) \times (0.1 + 0.0) \times 0.3 }{ 0.084 } \\
     &= \frac{ 0.8 \times 0.1 \times 0.3 }{ 0.084 } \\
     &= \frac{ 0.024 }{ 0.084 } \\
     &\approx 0.286,
\end{align*}
\begin{align*}
P(Y = 2 \, | \, (0, 2)) &= \frac{ P(X_1 = 0 \, | \, Y = 2)P(X_2 = 2 \, | \, Y = 2)P(Y = 2) }{ 0.084 } \\
     &= \frac{ (0.1 + 0.3 + 0.2) \times (0.2 + 0.0) \times 0.3 }{ 0.084 } \\
     &= \frac{ 0.6 \times 0.2 \times 0.3}{ 0.084 } \\
     &= \frac{ 0.036 }{ 0.084 } \\
     &\approx 0.429.
\end{align*}

\subsubsection*{$(1, 0)$}
If $\textbf{X} = (1, 0)$, and
\begin{align*}
P(\textbf{X}) &= \sum_{i = 0}^2 P(X_1 \, | \, Y = i)P(X_2 \, | \, Y = i)P(Y = i) \\
             &= (0.1 + 0.2 + 0.1) \times (0.2 + 0.1) \times 0.4 \\
             &+ (0.1 + 0.1 + 0.0) \times (0.6 + 0.1) \times 0.3 \\
             &+ (0.4 + 0.0 + 0.0) \times (0.1 + 0.4) \times 0.3 \\
             &= 0.4 \times 0.3 \times 0.4 + 0.2 \times 0.7 \times 0.3 + 0.4 \times 0.5 \times 0.3 \\
			 &= 0.048 + 0.042 +   0.06 \\
			 &= 0.15.
\end{align*}
\begin{align*}
P(Y = 0 \, | \, (1, 0)) &= \frac{P(X_1= 1 \, | \, Y = 0)P(X_2 = 0 \, | \, Y = 0)P(Y = 0)}{ 0.15 } \\
     &= \frac{ (0.1 + 0.2 + 0.1) \times (0.2 + 0.1) \times 0.4 }{ 0.15 } \\
     &= \frac{ 0.4 \times 0.3 \times 0.4 }{ 0.15 } \\
     &= \frac{ 0.048 }{ 0.15 } \\
     &= 0.32,
\end{align*}
\begin{align*}
P(Y = 1 \, | \, (1, 0)) &= \frac{ P(X_1 = 1 \, | \, Y = 1)P(X_2 = 0 \, | \,  Y = 1)P(Y = 1)}{ 0.15 } \\
     &= \frac{ (0.1 + 0.1 + 0.0) \times (0.6 + 0.1) \times 0.3 }{ 0.15 } \\
     &= \frac{ 0.2 \times 0.7 \times 0.3 }{ 0.15 } \\
     &= \frac{ 0.042 }{ 0.15 } \\
     &= 0.28,
\end{align*}
\begin{align*}
P(Y = 2 \, | \, (1, 0)) &= \frac{ P(X_1 = 1 \, | \, Y = 2)P(X_2 = 0 \, | \, Y = 2)P(Y = 2) }{ 0.15 } \\
     &= \frac{ (0.4 + 0.0 + 0.0) \times (0.1 + 0.4) \times 0.3 }{ 0.15 } \\
     &= \frac{ 0.4 \times 0.5 \times 0.3}{ 0.15 } \\
     &= \frac{ 0.06 }{ 0.15 } \\
     &= 0.4.
\end{align*}

\subsubsection*{$(1, 1)$}
If $\textbf{X} = (1, 1)$, and
\begin{align*}
P(\textbf{X}) &= \sum_{i = 0}^2 P(X_1 \, | \, Y = i)P(X_2 \, | \, Y = i)P(Y = i) \\
             &= (0.1 + 0.2 + 0.1) \times (0.4 + 0.2) \times 0.4 \\
             &+ (0.1 + 0.1 + 0.0) \times (0.1 + 0.1) \times 0.3 \\
             &+ (0.4 + 0.0 + 0.0) \times (0.3 + 0.0) \times 0.3 \\
             &= 0.4 \times 0.6 \times 0.4 + 0.2 \times 0.2 \times 0.3 + 0.4 \times 0.3 \times 0.3 \\
			 &= 0.096 + 0.012 + 0.036 \\
			 &= 0.144.
\end{align*}
\begin{align*}
P(Y = 0 \, | \, (1, 1)) &= \frac{P(X_1= 1 \, | \, Y = 0)P(X_2 = 1 \, | \, Y = 0)P(Y = 0)}{ 0.144 } \\
     &= \frac{ (0.1 + 0.2 + 0.1) \times (0.4 + 0.2) \times 0.4 }{ 0.144 } \\
     &= \frac{ 0.4 \times 0.6 \times 0.4 }{ 0.144 } \\
     &= \frac{ 0.096 }{ 0.144 } \\
     &\approx 0.667,
\end{align*}
\begin{align*}
P(Y = 1 \, | \, (1, 1)) &= \frac{ P(X_1 = 1 \, | \, Y = 1)P(X_2 = 1 \, | \,  Y = 1)P(Y = 1)}{ 0.144 } \\
     &= \frac{ (0.1 + 0.1 + 0.0) \times (0.1 + 0.1) \times 0.3 }{ 0.144 } \\
     &= \frac{ 0.2 \times 0.2 \times 0.3 }{ 0.144 } \\
     &= \frac{ 0.012 }{ 0.144 } \\
     &\approx 0.083,
\end{align*}
\begin{align*}
P(Y = 2 \, | \, (1, 1)) &= \frac{ P(X_1 = 1 \, | \, Y = 2)P(X_2 = 1 \, | \, Y = 2)P(Y = 2) }{ 0.144 } \\
     &= \frac{ (0.4 + 0.0 + 0.0) \times (0.3 + 0.0) \times 0.3 }{ 0.144 } \\
     &= \frac{ 0.4 \times 0.3 \times 0.3}{ 0.144 } \\
     &= \frac{ 0.036 }{ 0.144 } \\
     &= 0.25.
\end{align*}

\subsubsection*{$(1, 2)$}
If $\textbf{X} = (1, 2)$, and
\begin{align*}
P(\textbf{X}) &= \sum_{i = 0}^2 P(X_1 \, | \, Y = i)P(X_2 \, | \, Y = i)P(Y = i) \\
             &= (0.1 + 0.2 + 0.1) \times (0.0 + 0.1) \times 0.4 \\
             &+ (0.1 + 0.1 + 0.0) \times (0.1 + 0.0) \times 0.3 \\
             &+ (0.4 + 0.0 + 0.0) \times (0.2 + 0.0) \times 0.3 \\
             &= 0.4 \times 0.1 \times 0.4 + 0.2 \times 0.1 \times 0.3 + 0.4 \times 0.2 \times 0.3 \\
			 &=  0.016 + 0.006 +0.024 \\
			 &= 0.046.
\end{align*}
\begin{align*}
P(Y = 0 \, | \, (1, 2)) &= \frac{P(X_1= 1 \, | \, Y = 0)P(X_2 = 2 \, | \, Y = 0)P(Y = 0)}{ 0.046 } \\
     &= \frac{ (0.1 + 0.2 + 0.1) \times (0.0 + 0.1) \times 0.4 }{ 0.046 } \\
     &= \frac{ 0.4 \times 0.1 \times 0.4 }{ 0.046 } \\
     &= \frac{ 0.016 }{ 0.046 } \\
     &\approx 0.348,
\end{align*}
\begin{align*}
P(Y = 1 \, | \, (1, 1)) &= \frac{ P(X_1 = 1 \, | \, Y = 1)P(X_2 = 2 \, | \,  Y = 1)P(Y = 1)}{ 0.046 } \\
     &= \frac{ (0.1 + 0.1 + 0.0) \times (0.1 + 0.0) \times 0.3 }{ 0.046 } \\
     &= \frac{ 0.2 \times 0.1 \times 0.3 }{ 0.046 } \\
     &= \frac{ 0.006 }{ 0.046 } \\
     &\approx 0.130,
\end{align*}
\begin{align*}
P(Y = 2 \, | \, (1, 1)) &= \frac{ P(X_1 = 1 \, | \, Y = 2)P(X_2 = 2 \, | \, Y = 2)P(Y = 2) }{ 0.046 } \\
     &= \frac{ (0.4 + 0.0 + 0.0) \times (0.2 + 0.0) \times 0.3 }{ 0.046 } \\
     &= \frac{ 0.4 \times 0.2 \times 0.3}{ 0.046 } \\
     &= \frac{ 0.024 }{ 0.046 } \\
     &= 0.522.
\end{align*}

\subsubsection*{Summary}
\begin{tabular}{|l|c|c|c|}
  \hline
  & $Y = 0$ & $Y = 1$ & $Y = 2$ \\
  \hline
  $(0, 0)$ & 0.218 & 0.509 & 0.273 \\
  \hline
  $(0, 1)$ & 0.585 & 0.195 & 0.219 \\
  \hline
  $(0, 2)$ & 0.286 & 0.286 & 0.429 \\
  \hline
  $(1, 0)$ & 0.32 & 0.28 & 0.4 \\
  \hline
  $(1, 1)$ & 0.667 & 0.083 & 0.25 \\
  \hline
  $(1, 2)$ & 0.348 & 0.130 & 0.522 \\
  \hline
\end{tabular}

The Na√Øve Bayes classifier is
\begin{align*}
Y(\textbf{X}) = \begin{cases}
0 & \mbox{if } \textbf{X} \in \{ (0, 1), (1, 1) \} \\ 
1 & \mbox{if } \textbf{X} =  (0, 0) \\
2 & \mbox{if } \textbf{X} \in \{ (0, 2), (1, 0), (1, 2) \}.
\end{cases}
\end{align*}

\section*{Problem 2 (3 points)}

\section*{Problem 3 (15 points)}

\end{document}